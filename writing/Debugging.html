<div id="right-column">
<div aria-label="breadcrumbs navigation" role="navigation">
<ol class="breadcrumb">
<li><a href="../index.html">User Manual</a></li>
<li><a href="index.html">Writing scripts</a></li>
<li>Debugging</li>
</ol>
</div>
<div class="document clearer body">
<a class="reference external image-reference" href="https://www.tradingview.com/pine-script-docs/en/v5/Introduction.html"><div align="right" class="align-right"><img alt="Pine Script™ logo" height="100" src="../_images/Pine_Script_logo.svg" width="100"/></div>
</a>
<div class="section" id="debugging">
<span id="pagedebugging"></span><h1>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id1">Introduction</a></li>
<li><a class="reference internal" href="#the-lay-of-the-land" id="id2">The lay of the land</a></li>
<li><a class="reference internal" href="#displaying-numeric-values" id="id3">Displaying numeric values</a><ul>
<li><a class="reference internal" href="#when-the-script-s-scale-is-unimportant" id="id4">When the script’s scale is unimportant</a></li>
<li><a class="reference internal" href="#when-the-script-s-scale-must-be-preserved" id="id5">When the script’s scale must be preserved</a></li>
</ul>
</li>
<li><a class="reference internal" href="#displaying-strings" id="id6">Displaying strings</a><ul>
<li><a class="reference internal" href="#labels-on-each-bar" id="id7">Labels on each bar</a></li>
<li><a class="reference internal" href="#labels-on-last-bar" id="id8">Labels on last bar</a></li>
</ul>
</li>
<li><a class="reference internal" href="#debugging-conditions" id="id9">Debugging conditions</a><ul>
<li><a class="reference internal" href="#single-conditions" id="id10">Single conditions</a></li>
<li><a class="reference internal" href="#compound-conditions" id="id11">Compound conditions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#debugging-from-inside-functions" id="id12">Debugging from inside functions</a></li>
<li><a class="reference internal" href="#debugging-from-inside-for-loops" id="id13">Debugging from inside `for` loops</a><ul>
<li><a class="reference internal" href="#extracting-a-single-value" id="id14">Extracting a single value</a></li>
<li><a class="reference internal" href="#using-lines-and-labels" id="id15">Using lines and labels</a></li>
<li><a class="reference internal" href="#extracting-multiple-values" id="id16">Extracting multiple values</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tips" id="id17">Tips</a></li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id1">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>TradingView’s close integration between the Pine Script™ Editor and charts allows for efficient and interactive debugging of Pine Script™ code.
Once a Pine Script™ programmer understands the most appropriate technique to use in each situation, he will be able to debug scripts quickly and thoroughly.
This page demonstrates the most useful techniques to debug Pine Script™ code.</p>
<p>If you are not yet familiar with Pine Script™’s execution model, it is important that you read the <span class="xref std std-ref">Execution model</span> page of this User Manual
so you understand how your debugging code will behave in the Pine Script™ environment.</p>
</div>
<div class="section" id="the-lay-of-the-land">
<h2><a class="toc-backref" href="#id2">The lay of the land</a><a class="headerlink" href="#the-lay-of-the-land" title="Permalink to this headline">¶</a></h2>
<p>Values plotted by Pine scripts can be displayed in four distinct places:</p>
<ol class="arabic simple">
<li>Next to the script’s name (controlled by the “Indicator Values” checkbox in the “Chart settings/Status Line” tab).</li>
<li>In the script’s pane, whether your script is a chart overlay or in a separate pane.</li>
<li>In the scale (only displays the last bar’s value and is controlled by the “Indicator Last Value Label” checkbox in the “Chart settings/Scale” tab).</li>
<li>In the Data Window (which you can bring up using the fourth icon down, to the right of your chart).</li>
</ol>
<img alt="../_images/Debugging-TheLayOfTheLand-1.png" src="../_images/Debugging-TheLayOfTheLand-1.png"/>
<p>Note the following in the preceding screenshot:</p>
<ul class="simple">
<li>The chart’s cursor is on the dataset’s first bar, where <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a> is zero. That value is reflected next to the indicator’s name and in the Data Window.
<strong>Moving your cursor on other bars would update those values so they always represent the value of the plot on that bar.</strong>
This is a good way to inspect the value of a variable as the script’s execution progresses from bar to bar.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">title</span></code> argument of our <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plot">plot()</a> call, “Bar Index”, is used as the value’s legend in the Data Window.</li>
<li>The precision of the values displayed in the Data Window is dependent on the chart symbol’s tick value. You can modify it in two ways:<ul>
<li>By changing the value of the “Precision” field in the script’s “Settings/Style” tab. You can obtain up to eight digits of precision using this method.</li>
<li>By using the <code class="docutils literal notranslate"><span class="pre">precision</span></code> parameter in your script’s <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_indicator">indicator()</a> or <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_strategy">strategy()</a> declaration statement. This method allows specifying up to 16 digits precision.</li>
</ul>
</li>
<li>The <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plot">plot()</a> call in our script plots the value of <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a> in the indicator’s pane,
which shows the increasing value of the variable.</li>
<li>The scale of the script’s pane is automatically sized to accommodate the smallest and largest values plotted by all <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plot">plot()</a> calls in the script.</li>
</ul>
</div>
<div class="section" id="displaying-numeric-values">
<h2><a class="toc-backref" href="#id3">Displaying numeric values</a><a class="headerlink" href="#displaying-numeric-values" title="Permalink to this headline">¶</a></h2>
<div class="section" id="when-the-script-s-scale-is-unimportant">
<h3><a class="toc-backref" href="#id4">When the script’s scale is unimportant</a><a class="headerlink" href="#when-the-script-s-scale-is-unimportant" title="Permalink to this headline">¶</a></h3>
<p>The script in the preceding screenshot used the simplest way to inspect numerical values: a <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plot">plot()</a> call,
which plots a line corresponding to the variable’s value in the script’s display area.
Our example script plotted the value of the <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a> built-in variable,
which contains the bar’s number, a value beginning at zero on the dataset’s first bar and increased by one on each
subsequent bar. We used a <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plot">plot()</a> call to plot the variable to inspect because our script was not plotting anything else;
we were not preoccupied with preserving the scale for other plots to continue to plot normally. This is the script we used:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Plot `bar_index`"</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="s2">"Bar Index"</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="when-the-script-s-scale-must-be-preserved">
<span id="pagedebugging-whenthescriptsscalemustbepreserved"></span><h3><a class="toc-backref" href="#id5">When the script’s scale must be preserved</a><a class="headerlink" href="#when-the-script-s-scale-must-be-preserved" title="Permalink to this headline">¶</a></h3>
<p>Plotting values in the script’s display area is not always possible. When we already have other plots going on and adding debugging plots of variables whose values fall outside the script’s plotting boundaries would make the plots unreadable, another technique must be used to inspect values if we want to preserve the scale of the other plots.</p>
<p>Suppose we want to continue inspecting the value of <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a>, but this time in a script where we are also plotting RSI:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Plot RSI and `bar_index`"</span><span class="p">)</span><span class="w"></span>
<span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">ta.rsi</span><span class="p">(</span><span class="no">close</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="s2">"RSI"</span><span class="p">,</span><span class="w"> </span><span class="ni">color.black</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="s2">"Bar Index"</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>Running the script on a dataset containing a large number of bars yields the following display:</p>
<img alt="../_images/Debugging-DisplayingNumericValues-1.png" src="../_images/Debugging-DisplayingNumericValues-1.png"/>
<p>where:</p>
<ol class="arabic simple">
<li>The RSI line in black is flat because it varies between zero and 100, but the indicator’s pane is scaled to show the maximum value of <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a>, which is <code class="docutils literal notranslate"><span class="pre">25692.0000</span></code>.</li>
<li>The value of <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a> on the bar the cursor is on is displayed next to the indicator’s name, and its blue plot in the script’s pane is flat.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">25692.0000</span></code> value of <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a> shown in the scale represents its value on the last bar, so the dataset contains 25693 bars.</li>
<li>The value of <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a> on the bar the cursor is on is also displayed in the Data Window, along with that bar’s value for RSI just above it.</li>
</ol>
<p>In order to preserve our plot of RSI while still being able to inspect the value or <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a>,
we will plot the variable using <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar">plotchar()</a> like this:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Plot RSI and `bar_index`"</span><span class="p">)</span><span class="w"></span>
<span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">ta.rsi</span><span class="p">(</span><span class="no">close</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="s2">"RSI"</span><span class="p">,</span><span class="w"> </span><span class="ni">color.black</span><span class="p">)</span><span class="w"></span>
<span class="ni">plotchar</span><span class="p">(</span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="s2">"Bar index"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="ni">location.top</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<img alt="../_images/Debugging-DisplayingNumericValues-2.png" src="../_images/Debugging-DisplayingNumericValues-2.png"/>
<p>where:</p>
<ul class="simple">
<li>Because the value of <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_bar_index">bar_index</a> is no longer being plotted in the script’s pane, the pane’s boundaries are now those of RSI, which displays normally.</li>
<li>The value plotted using <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar">plotchar()</a> is displayed next to the script’s name and in the Data Window.</li>
<li>We are not plotting a character with our <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar">plotchar()</a> call, so the third argument is an empty string (<code class="docutils literal notranslate"><span class="pre">""</span></code>).
We are also specifying <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_location{dot}top">location.top</a> as the <code class="docutils literal notranslate"><span class="pre">location</span></code> argument, so that we do not put the symbol’s price in play in the calculation of the display area’s boundaries.</li>
</ul>
</div>
</div>
<div class="section" id="displaying-strings">
<h2><a class="toc-backref" href="#id6">Displaying strings</a><a class="headerlink" href="#displaying-strings" title="Permalink to this headline">¶</a></h2>
<p>Pine Script™ labels must be used to display strings. Labels only appear in the script’s display area; strings shown in labels do not appear in the Data Window or anywhere else.</p>
<div class="section" id="labels-on-each-bar">
<h3><a class="toc-backref" href="#id7">Labels on each bar</a><a class="headerlink" href="#labels-on-each-bar" title="Permalink to this headline">¶</a></h3>
<p>The following script demonstrates the simplest way to repetitively draw a label showing the symbol’s name:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Simple label"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="nx">true</span><span class="p">)</span><span class="w"></span>
<span class="ni">label.new</span><span class="p">(</span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="no">high</span><span class="p">,</span><span class="w"> </span><span class="ni">syminfo.ticker</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<img alt="../_images/Debugging-DisplayingStrings-1.png" src="../_images/Debugging-DisplayingStrings-1.png"/>
<p>By default, only the last 50 labels will be shown on the chart. You can increase this amount up to a maximum of 500 by using the <code class="docutils literal notranslate"><span class="pre">max_labels_count</span></code> parameter in your script’s <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_indicator">indicator()</a> or <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_strategy">strategy()</a> declaration statement. For example:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="ni">indicator</span><span class="p">(</span><span class="s2">"Simple label"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="nx">true</span><span class="p">,</span><span class="w"> </span><span class="nx">max_labels_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="labels-on-last-bar">
<h3><a class="toc-backref" href="#id8">Labels on last bar</a><a class="headerlink" href="#labels-on-last-bar" title="Permalink to this headline">¶</a></h3>
<p>As strings manipulated in Pine scripts often do not change bar to bar, the method most frequently used to visualize them is to draw a label on the dataset’s last bar.
Here, we use a function to create a label that only appears on the chart’s last bar. Our <code class="docutils literal notranslate"><span class="pre">f_print()</span></code> function has only one parameter, the text string to be displayed:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"print()"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="nx">true</span><span class="p">)</span><span class="w"></span>
<span class="nx">print</span><span class="p">(</span><span class="nx">txt</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="c">// Create label on the first bar.</span><span class="w"></span>
<span class="w">    </span><span class="k">var </span><span class="nx">lbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">label.new</span><span class="p">(</span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="no">na</span><span class="p">,</span><span class="w"> </span><span class="nx">txt</span><span class="p">,</span><span class="w"> </span><span class="ni">xloc.bar_index</span><span class="p">,</span><span class="w"> </span><span class="ni">yloc.price</span><span class="p">,</span><span class="w"> </span><span class="ni">color</span><span class="p">(</span><span class="no">na</span><span class="p">),</span><span class="w"> </span><span class="ni">label.style_none</span><span class="p">,</span><span class="w"> </span><span class="ni">color.gray</span><span class="p">,</span><span class="w"> </span><span class="ni">size.large</span><span class="p">,</span><span class="w"> </span><span class="ni">text.align_left</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">// On next bars, update the label's x and y position, and the text it displays.</span><span class="w"></span>
<span class="w">    </span><span class="ni">label.set_xy</span><span class="p">(</span><span class="nx">lbl</span><span class="p">,</span><span class="w"> </span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="ni">ta.highest</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="ni">label.set_text</span><span class="p">(</span><span class="nx">lbl</span><span class="p">,</span><span class="w"> </span><span class="nx">txt</span><span class="p">)</span><span class="w"></span>

<span class="nx">print</span><span class="p">(</span><span class="s2">"Multiplier = "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">str.tostring</span><span class="p">(</span><span class="ni">timeframe.multiplier</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"\nPeriod = "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">timeframe.period</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"\nHigh = "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">str.tostring</span><span class="p">(</span><span class="no">high</span><span class="p">))</span><span class="w"></span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"Hello world!\n\n\n\n"</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<img alt="../_images/Debugging-DisplayingStrings-2.png" src="../_images/Debugging-DisplayingStrings-2.png"/>
<p>Note the following in our last code example:</p>
<ul class="simple">
<li>We use the <code class="docutils literal notranslate"><span class="pre">print()</span></code> function to enclose the label-drawing code. While the function is called on each bar,
the label is only created on the dataset’s first bar because of our use of the
<a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#op_var">var</a> keyword when declaring the <code class="docutils literal notranslate"><span class="pre">lbl</span></code> variable inside the function. After creating it,
we only update the label’s <em>x</em> and <em>y</em> coordinates and its text on each successive bar. If we did not update those values, the label would remain on the dataset’s first bar
and would only display the text string’s value on that bar. Lastly, note that we use <code class="docutils literal notranslate"><span class="pre">ta.highest(10)[1]</span></code> to position the label vertically,
By using the highest high of the <strong>previous</strong> 10 bars, we prevent the label from moving during the realtime bar.
You may need to adapt this <em>y</em> position in other contexts.</li>
<li>We call the <code class="docutils literal notranslate"><span class="pre">print()</span></code> function twice to show that if you make multiple calls because it makes debugging multiple strings easier,
you can superimpose their text by using the correct amount of newlines (<code class="docutils literal notranslate"><span class="pre">\n</span></code>) to separate each one.</li>
<li>We use the <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_str{dot}tostring">str.tostring()</a> function to convert numeric values to a string for inclusion in the text to be displayed.</li>
</ul>
</div>
</div>
<div class="section" id="debugging-conditions">
<h2><a class="toc-backref" href="#id9">Debugging conditions</a><a class="headerlink" href="#debugging-conditions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="single-conditions">
<h3><a class="toc-backref" href="#id10">Single conditions</a><a class="headerlink" href="#single-conditions" title="Permalink to this headline">¶</a></h3>
<p>Many methods can be used to display occurrences where a condition is met. This code shows six ways to identify bars where RSI is smaller than 30:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Single conditions"</span><span class="p">)</span><span class="w"></span>
<span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">ta.rsi</span><span class="p">(</span><span class="no">close</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"></span>
<span class="nx">rIsLow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30</span><span class="w"></span>
<span class="ni">hline</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"></span>

<span class="c">// Method #1: Change the plot's color.</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="s2">"RSI"</span><span class="p">,</span><span class="w"> </span><span class="nx">rIsLow</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="ni">color.fuchsia</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="ni">color.black</span><span class="p">)</span><span class="w"></span>
<span class="c">// Method #2: Plot a character in the bottom region of the display.</span><span class="w"></span>
<span class="ni">plotchar</span><span class="p">(</span><span class="nx">rIsLow</span><span class="p">,</span><span class="w"> </span><span class="s2">"rIsLow char at bottom"</span><span class="p">,</span><span class="w"> </span><span class="s2">"▲"</span><span class="p">,</span><span class="w"> </span><span class="ni">location.bottom</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.small</span><span class="p">)</span><span class="w"></span>
<span class="c">// Method #3: Plot a character on the RSI line.</span><span class="w"></span>
<span class="ni">plotchar</span><span class="p">(</span><span class="nx">rIsLow</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">na</span><span class="p">,</span><span class="w"> </span><span class="s2">"rIsLow char on line"</span><span class="p">,</span><span class="w"> </span><span class="s2">"•"</span><span class="p">,</span><span class="w"> </span><span class="ni">location.absolute</span><span class="p">,</span><span class="w"> </span><span class="ni">color.red</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.small</span><span class="p">)</span><span class="w"></span>
<span class="c">// Method #4: Plot a shape in the top region of the display.</span><span class="w"></span>
<span class="ni">plotshape</span><span class="p">(</span><span class="nx">rIsLow</span><span class="p">,</span><span class="w"> </span><span class="s2">"rIsLow shape"</span><span class="p">,</span><span class="w"> </span><span class="ni">shape.arrowup</span><span class="p">,</span><span class="w"> </span><span class="ni">location.top</span><span class="p">)</span><span class="w"></span>
<span class="c">// Method #5: Plot an arrow.</span><span class="w"></span>
<span class="ni">plotarrow</span><span class="p">(</span><span class="nx">rIsLow</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">na</span><span class="p">,</span><span class="w"> </span><span class="s2">"rIsLow arrow"</span><span class="p">)</span><span class="w"></span>
<span class="c">// Method #6: Change the background's color.</span><span class="w"></span>
<span class="ni">bgcolor</span><span class="p">(</span><span class="nx">rIsLow</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="ni">color.new</span><span class="p">(</span><span class="ni">color.green</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">na</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<img alt="../_images/Debugging-DisplayingConditions-1.png" src="../_images/Debugging-DisplayingConditions-1.png"/>
<p>Note that:</p>
<ul class="simple">
<li>We define our condition in the <code class="docutils literal notranslate"><span class="pre">rIsLow</span></code> boolean variable and it is evaluated on each bar. The <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">&lt;</span> <span class="pre">30</span></code> expression used to assign a value to the variable evaluates to <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code> (or <code class="docutils literal notranslate"><span class="pre">na</span></code> when <code class="docutils literal notranslate"><span class="pre">r</span></code> is <code class="docutils literal notranslate"><span class="pre">na</span></code>, as is the case in the first bars of the dataset).</li>
<li><strong>Method #1</strong> uses a change in the color of the RSI plot on the condition. Whenever a plot’s color changes, it colors the plot starting from the preceding bar.</li>
<li><strong>Method #2</strong> uses <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar">plotchar()</a> to plot an up triangle in the bottom part of the indicator’s display.
Using different combinations of positions and characters allows the simultaneous identification of multiple conditions on a single bar.
<strong>This is one of our preferred methods to identify conditions on the chart.</strong></li>
<li><strong>Method #3</strong> also uses a <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar">plotchar()</a> call, but this time the character is positioned on the RSI line.
In order to achieve this, we use <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_location{dot}absolute">location.absolute</a> and Pine Script™’s
<a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#op_{question}{colon}">?:</a> ternary conditional operator to define a conditional expression
where a <em>y</em> position is used only when our <code class="docutils literal notranslate"><span class="pre">rIsLow</span></code> condition is true. When it is not true, <code class="docutils literal notranslate"><span class="pre">na</span></code> is used, so no character is displayed.</li>
<li><strong>Method #4</strong> uses <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape">plotshape()</a> to plot a blue up arrow in the top part of the indicator’s display area when our condition is met.</li>
<li><strong>Method #5</strong> uses <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow">plotarrow()</a> to plot a green up arrow at the bottom of the display when our condition is met.</li>
<li><strong>Method #6</strong> uses <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor">bgcolor()</a> to change the color of the background when our condition is met. The ternary operator is used once again to evaluate our condition.
It will return <code class="docutils literal notranslate"><span class="pre">color.green</span></code> when <code class="docutils literal notranslate"><span class="pre">rIsLow</span></code> is true, and the <code class="docutils literal notranslate"><span class="pre">na</span></code> color (which does not color the background) when <code class="docutils literal notranslate"><span class="pre">rIsLow</span></code> is false or <code class="docutils literal notranslate"><span class="pre">na</span></code>.</li>
<li>Lastly, note how a boolean variable with a <code class="docutils literal notranslate"><span class="pre">true</span></code> value displays as <code class="docutils literal notranslate"><span class="pre">1</span></code> in the Data Window. <code class="docutils literal notranslate"><span class="pre">false</span></code> values are denoted by a zero value.</li>
</ul>
</div>
<div class="section" id="compound-conditions">
<h3><a class="toc-backref" href="#id11">Compound conditions</a><a class="headerlink" href="#compound-conditions" title="Permalink to this headline">¶</a></h3>
<p>Programmers needing to identify situations where more than one condition is met must build compound conditions by aggregating individual conditions using the <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#op_and">and</a> logical operator. Because compound conditions will only perform as expected if their individual conditions trigger correctly, you will save yourself many headaches if you validate the behavior of individual conditions before using a compound condition in your code.</p>
<p>The state of multiple individual conditions can be displayed using a technique like this one, where four individual conditions are used to build our <code class="docutils literal notranslate"><span class="pre">bull</span></code> compound condition:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Compound conditions"</span><span class="p">)</span><span class="w"></span>
<span class="nx">periodInput</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="ni">input.int</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"></span>
<span class="nx">bullLevelInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">input.int</span><span class="p">(</span><span class="mi">55</span><span class="p">)</span><span class="w"></span>

<span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">ta.rsi</span><span class="p">(</span><span class="no">close</span><span class="p">,</span><span class="w"> </span><span class="nx">periodInput</span><span class="p">)</span><span class="w"></span>

<span class="c">// Condition #1.</span><span class="w"></span>
<span class="nx">rsiBull</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">bullLevelInput</span><span class="w"></span>
<span class="c">// Condition #2.</span><span class="w"></span>
<span class="nx">hiChannel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">ta.highest</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">periodInput</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"></span>
<span class="nx">aboveHiChannel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">hiChannel</span><span class="w"></span>
<span class="c">// Condition #3.</span><span class="w"></span>
<span class="nx">channelIsOld</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">hiChannel</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">hiChannel</span><span class="o">[</span><span class="nx">periodInput</span><span class="o">]</span><span class="w"></span>
<span class="c">// Condition #4.</span><span class="w"></span>
<span class="nx">historyIsBull</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">math.sum</span><span class="p">(</span><span class="nx">rsiBull</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">periodInput</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="c">// Compound condition.</span><span class="w"></span>
<span class="nx">bull</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rsiBull</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">aboveHiChannel</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">channelIsOld</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">historyIsBull</span><span class="w"></span>

<span class="ni">hline</span><span class="p">(</span><span class="nx">bullLevelInput</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="s2">"RSI"</span><span class="p">,</span><span class="w"> </span><span class="ni">color.black</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">hiChannel</span><span class="p">,</span><span class="w"> </span><span class="s2">"High Channel"</span><span class="p">)</span><span class="w"></span>

<span class="ni">plotchar</span><span class="p">(</span><span class="nx">rsiBull</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">bullLevelInput</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">na</span><span class="p">,</span><span class="w"> </span><span class="s2">"rIsBull"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="ni">location.absolute</span><span class="p">,</span><span class="w"> </span><span class="ni">color.green</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.tiny</span><span class="p">)</span><span class="w"></span>
<span class="ni">plotchar</span><span class="p">(</span><span class="nx">aboveHiChannel</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">na</span><span class="p">,</span><span class="w"> </span><span class="s2">"aboveHiChannel"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> </span><span class="ni">location.absolute</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.tiny</span><span class="p">)</span><span class="w"></span>
<span class="ni">plotchar</span><span class="p">(</span><span class="nx">channelIsOld</span><span class="p">,</span><span class="w"> </span><span class="s2">"channelIsOld"</span><span class="p">,</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w"> </span><span class="ni">location.bottom</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.tiny</span><span class="p">)</span><span class="w"></span>
<span class="ni">plotchar</span><span class="p">(</span><span class="nx">historyIsBull</span><span class="p">,</span><span class="w"> </span><span class="s2">"historyIsBull"</span><span class="p">,</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w"> </span><span class="ni">location.top</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.tiny</span><span class="p">)</span><span class="w"></span>
<span class="ni">bgcolor</span><span class="p">(</span><span class="nx">bull</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">not</span><span class="w"> </span><span class="nx">bull</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="ni">color.new</span><span class="p">(</span><span class="ni">color.green</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="ni">color.new</span><span class="p">(</span><span class="ni">color.green</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">na</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<img alt="../_images/Debugging-DisplayingConditions-2.png" src="../_images/Debugging-DisplayingConditions-2.png"/>
<p>Note that:</p>
<ul class="simple">
<li>We use a <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar">plotchar()</a> call to display each condition’s number, taking care to spread them over the indicator’s <em>y</em> space so they don’t overlap.</li>
<li>The first two <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar">plotchar()</a> calls use absolute positioning to place the condition number so that it helps us remember the corresponding condition.
The first one which displays “1” when RSI is higher than the user-defined bull level for example, positions the “1” on the bull level.</li>
<li>We use two different shades of green to color the background: the brighter one indicates the first bar where our compound condition becomes <code class="docutils literal notranslate"><span class="pre">true</span></code>,
the lighter green identifies subsequent bars where our compound condition continues to be true.</li>
<li>While it is not always strictly necessary to assign individual conditions to a variable because they can be used directly in boolean expressions,
it makes for more readable code when you assign a condition to a variable name that will remind you and your readers of what it represents.
Readability considerations should always prevail in cases like this one, where the hit on performance of assigning conditions to variable names is minimal or null.</li>
</ul>
</div>
</div>
<div class="section" id="debugging-from-inside-functions">
<h2><a class="toc-backref" href="#id12">Debugging from inside functions</a><a class="headerlink" href="#debugging-from-inside-functions" title="Permalink to this headline">¶</a></h2>
<p>Variables in function are local to the function, so not available for plotting from the script’s global scope.
In this script we have written the <code class="docutils literal notranslate"><span class="pre">hlca()</span></code> function to calculate a weighed average:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Debugging from inside functions"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="nx">true</span><span class="p">)</span><span class="w"></span>
<span class="nx">hlca</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="k">var float </span><span class="nx">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">na</span><span class="w"></span>
<span class="w">    </span><span class="nx">hlca</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">math.avg</span><span class="p">(</span><span class="no">high</span><span class="p">,</span><span class="w"> </span><span class="no">low</span><span class="p">,</span><span class="w"> </span><span class="no">close</span><span class="p">,</span><span class="w"> </span><span class="ni">nz</span><span class="p">(</span><span class="nx">avg</span><span class="p">,</span><span class="w"> </span><span class="no">close</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="nx">avg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="ni">ta.sma</span><span class="p">(</span><span class="nx">hlca</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"></span>

<span class="nx">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">hlca</span><span class="p">()</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>We need to inspect the value of <code class="docutils literal notranslate"><span class="pre">hlca</span></code> in the function’s local scope as the function calculates, bar to bar.
We cannot access the <code class="docutils literal notranslate"><span class="pre">hlca</span></code> variable used inside the function from the script’s global scope.
We thus need another mechanism to pull that variable’s value from inside the function’s local scope, while still being able to use the function’s result.
We can use Pine Script™’s ability to have functions return a tuple to gain access to the variable:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Debugging from inside functions"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="nx">true</span><span class="p">)</span><span class="w"></span>
<span class="nx">hlca</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="k">var float </span><span class="nx">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">na</span><span class="w"></span>
<span class="w">    </span><span class="nx">instantVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">math.avg</span><span class="p">(</span><span class="no">high</span><span class="p">,</span><span class="w"> </span><span class="no">low</span><span class="p">,</span><span class="w"> </span><span class="no">close</span><span class="p">,</span><span class="w"> </span><span class="ni">nz</span><span class="p">(</span><span class="nx">avg</span><span class="p">,</span><span class="w"> </span><span class="no">close</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="nx">avg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="ni">ta.sma</span><span class="p">(</span><span class="nx">instantVal</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">// Return two values instead of one.</span><span class="w"></span>
<span class="w">    </span><span class="o">[</span><span class="nx">avg</span><span class="p">,</span><span class="w"> </span><span class="nx">instantVal</span><span class="o">]</span><span class="w"></span>

<span class="o">[</span><span class="nx">h</span><span class="p">,</span><span class="w"> </span><span class="nx">instantVal</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">hlca</span><span class="p">()</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="w"> </span><span class="s2">"h"</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">instantVal</span><span class="p">,</span><span class="w"> </span><span class="s2">"instantVal"</span><span class="p">,</span><span class="w"> </span><span class="ni">color.black</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<img alt="../_images/Debugging-DebuggingFromInsideFunctions-1.png" src="../_images/Debugging-DebuggingFromInsideFunctions-1.png"/>
<p>Contrary to global scope variables, array elements of globally defined arrays can be modified from within functions.
We can use this feature to write a functionally equivalent script:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Debugging from inside functions"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="nx">true</span><span class="p">)</span><span class="w"></span>
<span class="c">// Create an array containing only one float element.</span><span class="w"></span>
<span class="nx">instantValGlobal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">array.new_float</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nx">hlca</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"></span>
<span class="w">    </span><span class="k">var float </span><span class="nx">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">na</span><span class="w"></span>
<span class="w">    </span><span class="nx">instantVal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">math.avg</span><span class="p">(</span><span class="no">high</span><span class="p">,</span><span class="w"> </span><span class="no">low</span><span class="p">,</span><span class="w"> </span><span class="no">close</span><span class="p">,</span><span class="w"> </span><span class="ni">nz</span><span class="p">(</span><span class="nx">avg</span><span class="p">,</span><span class="w"> </span><span class="no">close</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="c">// Set the array's only element to the current value of `_instantVal`.</span><span class="w"></span>
<span class="w">    </span><span class="ni">array.set</span><span class="p">(</span><span class="nx">instantValGlobal</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nx">instantVal</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="nx">avg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="ni">ta.sma</span><span class="p">(</span><span class="nx">instantVal</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"></span>

<span class="nx">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">hlca</span><span class="p">()</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="w"> </span><span class="s2">"h"</span><span class="p">)</span><span class="w"></span>
<span class="c">// Retrieve the value of the array's only element which was set from inside the function.</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="ni">array.get</span><span class="p">(</span><span class="nx">instantValGlobal</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="s2">"instantValGlobal"</span><span class="p">,</span><span class="w"> </span><span class="ni">color.black</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="debugging-from-inside-for-loops">
<h2><a class="toc-backref" href="#id13">Debugging from inside `for` loops</a><a class="headerlink" href="#debugging-from-inside-for-loops" title="Permalink to this headline">¶</a></h2>
<p>Values inside <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#op_for">for</a> loops cannot be plotted using <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plot">plot()</a> calls in the loop. As in functions, such variables are also local to the loop’s scope. Here, we explore three different techniques to inspect variable values originating from <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#op_for">for</a> loops, starting from this code example, which calculates the balance of bars in the lookback period which have a higher/lower true range value than the current bar:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Debugging from inside `for` loops"</span><span class="p">)</span><span class="w"></span>
<span class="nx">lookbackInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">input.int</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="k">float </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="k">for </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">lookbackInput</span><span class="w"></span>
<span class="w">    </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">math.sign</span><span class="p">(</span><span class="ni">ta.tr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="ni">hline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">trBalance</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="section" id="extracting-a-single-value">
<h3><a class="toc-backref" href="#id14">Extracting a single value</a><a class="headerlink" href="#extracting-a-single-value" title="Permalink to this headline">¶</a></h3>
<p>If we want to inspect the value of a variable at a single point in the loop, we can save it and plot it once the loop is exited. Here, we save the value of <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_ta{dot}tr">tr</a> in the <code class="docutils literal notranslate"><span class="pre">val</span></code> variable at the loop’s last iteration:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Debugging from inside `for` loops"</span><span class="p">,</span><span class="w"> </span><span class="nx">max_lines_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="nx">max_labels_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="p">)</span><span class="w"></span>
<span class="nx">lookbackInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">input.int</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="k">float </span><span class="nx">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">na</span><span class="w"></span>
<span class="k">float </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="k">for </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">lookbackInput</span><span class="w"></span>
<span class="w">    </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">math.sign</span><span class="p">(</span><span class="ni">ta.tr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if </span><span class="nx">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">lookbackInput</span><span class="w"></span>
<span class="w">        </span><span class="nx">val</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="w"></span>
<span class="ni">hline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">trBalance</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span><span class="w"> </span><span class="s2">"val"</span><span class="p">,</span><span class="w"> </span><span class="ni">color.black</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<img alt="../_images/Debugging-DebuggingFromInsideForLoops-1.png" src="../_images/Debugging-DebuggingFromInsideForLoops-1.png"/>
</div>
<div class="section" id="using-lines-and-labels">
<h3><a class="toc-backref" href="#id15">Using lines and labels</a><a class="headerlink" href="#using-lines-and-labels" title="Permalink to this headline">¶</a></h3>
<p>When we want to extract values from more than one loop iteration we can use lines and labels.
Here we draw a line corresponding to the value of <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_ta{dot}tr">ta.tr</a> used in each loop iteration.
We also use a label to display, for each line, the loop’s index and the line’s value.
This gives us a general idea of the values being used in each loop iteration:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Debugging from inside `for` loops"</span><span class="p">,</span><span class="w"> </span><span class="nx">max_lines_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="nx">max_labels_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="p">)</span><span class="w"></span>
<span class="nx">lookbackInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">input.int</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="k">float </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="k">for </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">lookbackInput</span><span class="w"></span>
<span class="w">    </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">math.sign</span><span class="p">(</span><span class="ni">ta.tr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="ni">line.new</span><span class="p">(</span><span class="ni">bar_index</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">color </span><span class="o">=</span><span class="w"> </span><span class="ni">color.black</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="ni">label.new</span><span class="p">(</span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="ni">str.tostring</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"•"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">str.tostring</span><span class="p">(</span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">),</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">label.style_none</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.small</span><span class="p">)</span><span class="w"></span>

<span class="ni">hline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">trBalance</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<img alt="../_images/Debugging-DebuggingFromInsideForLoops-2.png" src="../_images/Debugging-DebuggingFromInsideForLoops-2.png"/>
<p>Note that:</p>
<ul class="simple">
<li>To show more detail, the scale in the preceding screenshot has been manually expanded by clicking and dragging the scale area.</li>
<li>We use <code class="docutils literal notranslate"><span class="pre">max_lines_count</span> <span class="pre">=</span> <span class="pre">500,</span> <span class="pre">max_labels_count</span> <span class="pre">=</span> <span class="pre">500</span></code> in our <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v4/#fun_indicator">indicator()</a> declaration statement to display the maximum number of lines and labels.</li>
<li>Each loop iteration does not necessarily produce a distinct <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#var_ta{dot}tr">ta.tr</a> value, which is why we may not see 20 distinct lines for each bar.</li>
<li>If we wanted to show only one level, we could use the same technique while isolating a specific loop iteration as we did in the preceding example.</li>
</ul>
</div>
<div class="section" id="extracting-multiple-values">
<h3><a class="toc-backref" href="#id16">Extracting multiple values</a><a class="headerlink" href="#extracting-multiple-values" title="Permalink to this headline">¶</a></h3>
<p>We can also extract multiple values from loop iterations by building a single string which we will display using a label after the loop executes:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="c">//@version=5</span><span class="w"></span>
<span class="ni">indicator</span><span class="p">(</span><span class="s2">"Debugging from inside `for` loops"</span><span class="p">,</span><span class="w"> </span><span class="nx">max_lines_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="nx">max_labels_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="p">)</span><span class="w"></span>
<span class="nx">lookbackInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">input.int</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="nx">minval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="k">string </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w"></span>
<span class="k">float </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="k">for </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">lookbackInput</span><span class="w"></span>
<span class="w">    </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">trBalance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">math.sign</span><span class="p">(</span><span class="ni">ta.tr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">string </span><span class="o">:=</span><span class="w"> </span><span class="k">string </span><span class="o">+</span><span class="w"> </span><span class="ni">str.tostring</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"00"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"•"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">str.tostring</span><span class="p">(</span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"\n"</span><span class="w"></span>

<span class="ni">label.new</span><span class="p">(</span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="ni">string</span><span class="p">,</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">label.style_none</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.small</span><span class="p">,</span><span class="w"> </span><span class="nx">textalign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">text.align_left</span><span class="p">)</span><span class="w"></span>
<span class="ni">hline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="ni">plot</span><span class="p">(</span><span class="nx">trBalance</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<img alt="../_images/Debugging-DebuggingFromInsideForLoops-3.png" src="../_images/Debugging-DebuggingFromInsideForLoops-3.png"/>
<p>Note that:</p>
<ul class="simple">
<li>The scale in the preceding screenshot has been manually expanded by clicking and dragging the scale area so the content of the indicator’s display area content could be moved vertically to show only its relevant part.</li>
<li>We use <code class="docutils literal notranslate"><span class="pre">str.tostring(i,</span> <span class="pre">"00")</span></code> to force the display of the loop’s index to zero-padded two digits so they align neatly.</li>
</ul>
<p>When loops with numerous iterations make displaying all their values impractical, you can sample a subset of the iterations. This code uses the <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#op_{percent}">%</a> (modulo) operator to include values from every second loop iteration:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="k">for </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">i_lookBack</span><span class="w"></span>
<span class="w">    </span><span class="nx">lowerRangeBalance</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">lowerRangeBalance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">math.sign</span><span class="p">(</span><span class="ni">ta.tr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if </span><span class="nx">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="k">string </span><span class="o">:=</span><span class="w"> </span><span class="k">string </span><span class="o">+</span><span class="w"> </span><span class="ni">str.tostring</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"00"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"•"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ni">str.tostring</span><span class="p">(</span><span class="ni">ta.tr</span><span class="o">[</span><span class="nx">i</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"\n"</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tips">
<h2><a class="toc-backref" href="#id17">Tips</a><a class="headerlink" href="#tips" title="Permalink to this headline">¶</a></h2>
<p>The two techniques we use most frequently to debug our Pine Script™ code are:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="ni">plotchar</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span><span class="w"> </span><span class="s2">"v"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="ni">location.top</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.tiny</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>to plot variables of type <em>float</em>, <em>int</em> or <em>bool</em> in the indicator’s values and the Data Window, and the one-line version of our <code class="docutils literal notranslate"><span class="pre">print()</span></code> function to debug strings:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="nx">print</span><span class="p">(</span><span class="nx">txt</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">var </span><span class="nx">_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">label.new</span><span class="p">(</span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="no">na</span><span class="p">,</span><span class="w"> </span><span class="nx">txt</span><span class="p">,</span><span class="w"> </span><span class="ni">xloc.bar_index</span><span class="p">,</span><span class="w"> </span><span class="ni">yloc.price</span><span class="p">,</span><span class="w"> </span><span class="ni">color</span><span class="p">(</span><span class="no">na</span><span class="p">),</span><span class="w"> </span><span class="ni">label.style_none</span><span class="p">,</span><span class="w"> </span><span class="ni">color.gray</span><span class="p">,</span><span class="w"> </span><span class="ni">size.large</span><span class="p">,</span><span class="w"> </span><span class="ni">text.align_left</span><span class="p">),</span><span class="w"> </span><span class="ni">label.set_xy</span><span class="p">(</span><span class="nx">_label</span><span class="p">,</span><span class="w"> </span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="ni">ta.highest</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">),</span><span class="w"> </span><span class="ni">label.set_text</span><span class="p">(</span><span class="nx">_label</span><span class="p">,</span><span class="w"> </span><span class="nx">txt</span><span class="p">)</span><span class="w"></span>
<span class="nx">print</span><span class="p">(</span><span class="nx">stringName</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>As we use AutoHotkey for Windows to speed repetitive tasks, we include these lines in our AutoHotkey script (this is <strong>not</strong> Pine Script™ code):</p>
<div class="highlight-ahk notranslate"><div class="highlight"><pre><span></span><span class="c1">; ————— This is AHK code, not Pine Script™. —————</span>
<span class="o">^+</span><span class="n">f</span><span class="o">::</span> <span class="n">SendInput</span> <span class="n">plotchar</span><span class="p">(</span><span class="o">^</span><span class="n">v</span><span class="p">,</span> <span class="s">"^v"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="n">location</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="o">.</span><span class="n">tiny</span><span class="p">){</span><span class="n">Return</span><span class="p">}</span>
<span class="o">^+</span><span class="n">p</span><span class="o">::</span> <span class="n">SendInput</span> <span class="n">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">var</span> <span class="n">lbl</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">bar_index</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">xloc</span><span class="o">.</span><span class="n">bar_index</span><span class="p">,</span> <span class="n">yloc</span><span class="o">.</span><span class="n">price</span><span class="p">,</span> <span class="n">color</span><span class="p">(</span><span class="n">na</span><span class="p">),</span> <span class="n">label</span><span class="o">.</span><span class="n">style_none</span><span class="p">,</span> <span class="n">color</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">size</span><span class="o">.</span><span class="n">large</span><span class="p">,</span> <span class="n">text</span><span class="o">.</span><span class="n">align_left</span><span class="p">),</span> <span class="n">label</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">bar_index</span><span class="p">,</span> <span class="n">highest</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">label</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span><span class="se">`n</span><span class="n">print</span><span class="p">(){</span><span class="n">Left</span><span class="p">}</span>
</pre></div>
</div>
<p>The second line will type a debugging <a class="reference external" href="https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar">plotchar()</a> call including an expression or variable name previously copied to the clipboard when we use <kbd class="kbd docutils literal notranslate">ctrl</kbd> + <kbd class="kbd docutils literal notranslate">shift</kbd> + <kbd class="kbd docutils literal notranslate">f</kbd>.
Copying the <code class="docutils literal notranslate"><span class="pre">variableName</span></code> variable name or the <code class="docutils literal notranslate"><span class="pre">close</span> <span class="pre">&gt;</span> <span class="pre">open</span></code> conditional expression to the clipboard and hitting <kbd class="kbd docutils literal notranslate">ctrl</kbd> + <kbd class="kbd docutils literal notranslate">shift</kbd> + <kbd class="kbd docutils literal notranslate">f</kbd> will, respectively, yield:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="ni">plotchar</span><span class="p">(</span><span class="nx">variableName</span><span class="p">,</span><span class="w"> </span><span class="s2">"variableName"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="ni">location.top</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.tiny</span><span class="p">)</span><span class="w"></span>
<span class="ni">plotchar</span><span class="p">(</span><span class="no">close</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="no">open</span><span class="p">,</span><span class="w"> </span><span class="s2">"close &gt; open"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="ni">location.top</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">size.tiny</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>The third line triggers on <kbd class="kbd docutils literal notranslate">ctrl</kbd> + <kbd class="kbd docutils literal notranslate">shift</kbd> + <kbd class="kbd docutils literal notranslate">p</kbd>. It types our one-line <code class="docutils literal notranslate"><span class="pre">print()</span></code> function in a script and on a second line,
an empty call to the function with the cursor placed so all that’s left to do is type the string we want to display:</p>
<div class="highlight-pine notranslate"><div class="highlight"><pre><span></span><span class="nx">print</span><span class="p">(</span><span class="nx">txt</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">var </span><span class="nx">lbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">label.new</span><span class="p">(</span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="no">na</span><span class="p">,</span><span class="w"> </span><span class="nx">txt</span><span class="p">,</span><span class="w"> </span><span class="ni">xloc.bar_index</span><span class="p">,</span><span class="w"> </span><span class="ni">yloc.price</span><span class="p">,</span><span class="w"> </span><span class="ni">color</span><span class="p">(</span><span class="no">na</span><span class="p">),</span><span class="w"> </span><span class="ni">label.style_none</span><span class="p">,</span><span class="w"> </span><span class="ni">color.gray</span><span class="p">,</span><span class="w"> </span><span class="ni">size.large</span><span class="p">,</span><span class="w"> </span><span class="ni">text.align_left</span><span class="p">),</span><span class="w"> </span><span class="ni">label.set_xy</span><span class="p">(</span><span class="nx">lbl</span><span class="p">,</span><span class="w"> </span><span class="ni">bar_index</span><span class="p">,</span><span class="w"> </span><span class="ni">ta.highest</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">),</span><span class="w"> </span><span class="ni">label.set_text</span><span class="p">(</span><span class="nx">lbl</span><span class="p">,</span><span class="w"> </span><span class="nx">txt</span><span class="p">)</span><span class="w"></span>
<span class="nx">print</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
<p>Note: AutoHotkey works only on Windows systems. Keyboard Maestro or others can be substituted on Apple systems.</p>
<a class="reference external image-reference" href="https://www.tradingview.com/"><div align="center" class="align-center"><img alt="../_images/TradingView-Logo-Block.svg" src="../_images/TradingView-Logo-Block.svg" width="200px"/></div>
</a>
</div>
</div>
</div>
<div class="footer-relations">
<div class="pull-left">
<a class="btn btn-default" href="Style_guide.html" title="previous chapter (use the left arrow)">Style guide</a>
</div>
<div class="pull-right">
<a class="btn btn-default" href="Publishing.html" title="next chapter (use the right arrow)">Publishing scripts</a>
</div>
</div>
<div class="clearer"></div>
</div>